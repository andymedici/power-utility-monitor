{% extends "base.html" %}

{% block content %}
<div class="row mb-4">
    <div class="col">
        <h1><i class="bi bi-bell"></i> Email Alerts</h1>
        <p class="text-muted">Get notified when new high-value projects are discovered</p>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5><i class="bi bi-plus-circle"></i> Subscribe to Alerts</h5>
            </div>
            <div class="card-body">
                <form action="{{ url_for('subscribe_alerts') }}" method="post">
                    <div class="mb-3">
                        <label class="form-label">Email Address</label>
                        <input type="email" name="email" class="form-control" required 
                               placeholder="your.email@company.com">
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Minimum Capacity (MW)</label>
                        <input type="number" name="min_capacity" class="form-control" 
                               value="200" min="100" step="50">
                        <small class="form-text text-muted">Only notify for projects above this capacity</small>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">States (optional)</label>
                        <select name="states" class="form-select" multiple>
                            <option value="VA">Virginia</option>
                            <option value="CA">California</option>
                            <option value="TX">Texas</option>
                            <option value="NY">New York</option>
                            <option value="IL">Illinois</option>
                            <option value="PA">Pennsylvania</option>
                            <option value="OH">Ohio</option>
                            <option value="FL">Florida</option>
                            <option value="WA">Washington</option>
                            <option value="OR">Oregon</option>
                        </select>
                        <small class="form-text text-muted">Hold Ctrl/Cmd to select multiple. Leave blank for all states.</small>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">
                        <i class="bi bi-bell-fill"></i> Subscribe
                    </button>
                </form>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5><i class="bi bi-info-circle"></i> How It Works</h5>
            </div>
            <div class="card-body">
                <h6>Alert System:</h6>
                <ul>
                    <li>Daily monitoring scans all free data sources</li>
                    <li>New projects matching your criteria trigger emails</li>
                    <li>Alerts include project details and source links</li>
                    <li>Free email service via Resend</li>
                </ul>
                
                <h6 class="mt-3">Data Sources Monitored:</h6>
                <ul>
                    <li><strong>FERC eLibrary</strong> - National coverage</li>
                    <li><strong>CAISO</strong> - California projects</li>
                    <li><strong>PJM</strong> - Northern Virginia + 12 states</li>
                    <li><strong>ERCOT</strong> - Texas projects</li>
                    <li><strong>State PUCs</strong> - Regulatory filings</li>
                </ul>
                
                <h6 class="mt-3">You'll Get Alerts For:</h6>
                <ul>
                    <li>üè¢ Data centers (100+ MW)</li>
                    <li>üè≠ Manufacturing facilities</li>
                    <li>‚ö° High capacity projects (200+ MW)</li>
                    <li>üìç Your selected states only</li>
                </ul>
            </div>
        </div>
        
        {% if subscriptions %}
        <div class="card mt-3">
            <div class="card-header">
                <h5><i class="bi bi-people"></i> Active Subscriptions</h5>
            </div>
            <div class="card-body">
                {% for sub in subscriptions %}
                <div class="d-flex justify-content-between mb-2">
                    <div>
                        <strong>{{ sub.email }}</strong><br>
                        <small class="text-muted">{{ sub.min_capacity }}+ MW</small>
                    </div>
                    <span class="badge bg-success">Active</span>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}