{% extends "base.html" %}
{% block title %}{{ project.project_name }} - Project Details{% endblock %}
{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{{ url_for('index') }}">Dashboard</a></li>
                <li class="breadcrumb-item"><a href="{{ url_for('projects') }}">Projects</a></li>
                <li class="breadcrumb-item active">{{ project.request_id }}</li>
            </ol>
        </nav>
    </div>
</div>

<div class="row">
    <div class="col-lg-8">
        <div class="card mb-4">
            <div class="card-header bg-white">
                <div class="d-flex justify-content-between align-items-start">
                    <h3 class="mb-0">{{ project.project_name }}</h3>
                    <span class="hunter-score-badge {% if project.hunter_score >= 70 %}score-high{% elif project.hunter_score >= 40 %}score-medium{% else %}score-low{% endif %}">
                        Score: {{ project.hunter_score }}
                    </span>
                </div>
            </div>
            <div class="card-body">
                <dl class="row">
                    <dt class="col-sm-3">Request ID</dt>
                    <dd class="col-sm-9"><code>{{ project.request_id }}</code></dd>
                    
                    <dt class="col-sm-3">Capacity</dt>
                    <dd class="col-sm-9"><strong class="text-primary">{{ "%.2f"|format(project.capacity_mw) }} MW</strong></dd>
                    
                    <dt class="col-sm-3">Customer</dt>
                    <dd class="col-sm-9">{{ project.customer or 'Unknown' }}</dd>
                    
                    <dt class="col-sm-3">Location</dt>
                    <dd class="col-sm-9">
                        {{ project.county or 'Unknown' }}, {{ project.state or 'Unknown' }}
                        {% if 'loudoun' in (project.county or '').lower() %}
                            <span class="badge bg-danger">DC Hotspot</span>
                        {% endif %}
                    </dd>
                    
                    <dt class="col-sm-3">Utility/ISO</dt>
                    <dd class="col-sm-9">{{ project.utility or project.source }}</dd>
                    
                    <dt class="col-sm-3">Fuel Type</dt>
                    <dd class="col-sm-9"><span class="badge bg-secondary">{{ project.fuel_type or 'Unknown' }}</span></dd>
                    
                    <dt class="col-sm-3">Status</dt>
                    <dd class="col-sm-9"><span class="badge bg-success">{{ project.status or 'Active' }}</span></dd>
                    
                    <dt class="col-sm-3">Data Source</dt>
                    <dd class="col-sm-9">
                        <span class="source-badge badge bg-info">{{ project.source }}</span>
                        {% if project.source_url %}
                        <a href="{{ project.source_url }}" target="_blank" class="btn btn-sm btn-outline-primary ms-2">
                            <i class="bi bi-box-arrow-up-right"></i> View Source
                        </a>
                        {% endif %}
                    </dd>
                    
                    <dt class="col-sm-3">Added Date</dt>
                    <dd class="col-sm-9">{{ project.created_at.strftime('%B %d, %Y at %I:%M %p') if project.created_at else 'Unknown' }}</dd>
                </dl>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header bg-white">
                <h5 class="mb-0">Detection Signals</h5>
            </div>
            <div class="card-body">
                <p class="mb-2"><strong>Hunter Notes:</strong></p>
                <p class="text-muted">{{ project.hunter_notes or 'No detection signals available' }}</p>
            </div>
        </div>
    </div>
    
    <div class="col-lg-4">
        <div class="card mb-4">
            <div class="card-header bg-white">
                <h5 class="mb-0">Actions</h5>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <a href="{{ url_for('projects', state=project.state) }}" class="btn btn-outline-primary">
                        <i class="bi bi-geo-alt"></i> More in {{ project.state }}
                    </a>
                    <a href="{{ url_for('export_csv', min_score=project.hunter_score) }}" class="btn btn-outline-success">
                        <i class="bi bi-download"></i> Export Similar
                    </a>
                </div>
            </div>
        </div>
        
        {% if similar %}
        <div class="card">
            <div class="card-header bg-white">
                <h5 class="mb-0">Similar Projects</h5>
            </div>
            <ul class="list-group list-group-flush">
                {% for sim in similar %}
                <li class="list-group-item">
                    <a href="{{ url_for('project_detail', id=sim.id) }}" class="text-decoration-none">
                        <div class="d-flex justify-content-between">
                            <strong>{{ sim.project_name[:30] }}...</strong>
                            <span class="badge bg-primary">{{ sim.hunter_score }}</span>
                        </div>
                        <small class="text-muted">{{ "%.0f"|format(sim.capacity_mw) }} MW | {{ sim.county }}, {{ sim.state }}</small>
                    </a>
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
