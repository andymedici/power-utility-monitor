{% extends "base.html" %}
{% block title %}{{ project.project_name[:50] }} - Power Monitor{% endblock %}

{% block content %}
<!-- Back Button -->
<div class="mb-4">
    <a href="{{ url_for('projects') }}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Back to Projects
    </a>
</div>

<div class="row">
    <!-- Main Info -->
    <div class="col-md-8 mb-4">
        <div class="card">
            <div class="card-header bg-white d-flex justify-content-between align-items-center">
                <h4 class="mb-0">{{ project.project_name }}</h4>
                {% if project.hunter_score > 0 %}
                <span class="hunter-score-badge {% if project.hunter_score >= 70 %}score-high{% elif project.hunter_score >= 40 %}score-medium{% else %}score-low{% endif %}" style="font-size: 1.2rem; padding: 10px 15px;">
                    {{ project.hunter_score }}
                </span>
                {% endif %}
            </div>
            <div class="card-body">
                <table class="table table-borderless">
                    <tr>
                        <th style="width: 150px;">Request ID</th>
                        <td><code>{{ project.request_id }}</code></td>
                    </tr>
                    <tr>
                        <th>Capacity</th>
                        <td><strong class="text-primary" style="font-size: 1.5rem;">{{ "%.0f"|format(project.capacity_mw) }} MW</strong></td>
                    </tr>
                    <tr>
                        <th>Customer</th>
                        <td>{{ project.customer or 'Not specified' }}</td>
                    </tr>
                    <tr>
                        <th>Location</th>
                        <td>
                            {% if project.county %}{{ project.county }}, {% endif %}{{ project.state or 'Unknown' }}
                            {% if 'loudoun' in (project.county or '').lower() %}
                            <span class="badge bg-danger ms-2">ðŸ”¥ DC Hotspot</span>
                            {% endif %}
                        </td>
                    </tr>
                    <tr>
                        <th>Project Type</th>
                        <td>
                            <span class="badge bg-info">{{ project.project_type or 'other' }}</span>
                            {% if project.fuel_type %}
                            <span class="badge bg-secondary ms-1">{{ project.fuel_type }}</span>
                            {% endif %}
                        </td>
                    </tr>
                    <tr>
                        <th>Status</th>
                        <td>{{ project.status or 'Active' }}</td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
    
    <!-- Side Panel -->
    <div class="col-md-4 mb-4">
        <div class="card mb-4">
            <div class="card-header bg-white">
                <h5 class="mb-0"><i class="bi bi-info-circle"></i> Source Info</h5>
            </div>
            <div class="card-body">
                <p>
                    <strong>ISO/RTO:</strong><br>
                    <span class="utility-badge utility-{{ project.utility }}">{{ project.utility }}</span>
                </p>
                <p>
                    <strong>Source:</strong><br>
                    {{ project.source }}
                </p>
                <p>
                    <strong>First Seen:</strong><br>
                    {{ project.first_seen }}
                </p>
                <p>
                    <strong>Last Updated:</strong><br>
                    {{ project.last_updated }}
                </p>
            </div>
        </div>
        
        {% if project.hunter_score >= 40 %}
        <div class="card border-warning">
            <div class="card-header bg-warning text-dark">
                <h5 class="mb-0"><i class="bi bi-lightning-charge"></i> Why This Score?</h5>
            </div>
            <div class="card-body">
                <ul class="mb-0">
                    {% if 'data center' in (project.project_name or '').lower() or 'datacenter' in (project.project_name or '').lower() %}
                    <li>Contains "data center" in name (+40)</li>
                    {% endif %}
                    {% if 'microsoft' in (project.customer or '').lower() or 'amazon' in (project.customer or '').lower() or 'google' in (project.customer or '').lower() %}
                    <li>Major tech company customer (+35)</li>
                    {% endif %}
                    {% if 'loudoun' in (project.county or '').lower() %}
                    <li>Loudoun County, VA (DC hotspot) (+15)</li>
                    {% endif %}
                    {% if project.capacity_mw >= 500 %}
                    <li>Very high capacity (500+ MW) (+10)</li>
                    {% elif project.capacity_mw >= 200 %}
                    <li>High capacity (200+ MW) (+5)</li>
                    {% endif %}
                </ul>
            </div>
        </div>
        {% endif %}
    </div>
</div>

<!-- Similar Projects -->
<div class="card">
    <div class="card-header bg-white">
        <h5 class="mb-0"><i class="bi bi-collection"></i> Similar Projects in {{ project.state or 'Area' }}</h5>
    </div>
    <div class="card-body">
        <p class="text-muted">
            <a href="{{ url_for('projects', state=project.state) }}" class="btn btn-outline-primary btn-sm">
                View all projects in {{ project.state or 'this state' }} â†’
            </a>
        </p>
    </div>
</div>
{% endblock %}
